# word2vec
## ä»€ä¹ˆæ˜¯word2vec
word2vec æ˜¯ Google åœ¨ 2013 å¹´å¹´ä¸­å¼€æºçš„ä¸€æ¬¾å°†è¯è¡¨å¾ä¸ºå®æ•°å€¼å‘é‡çš„é«˜æ•ˆ å·¥å…·ï¼Œé‡‡ç”¨çš„æ¨¡å‹æœ‰ CBOW(Continuous Bag-Of-Wordsï¼Œå³è¿ç»­çš„è¯è¢‹æ¨¡å‹)å’Œ Skip-Gram ä¸¤ç§ã€‚word2vec ä»£ç é“¾æ¥ä¸º:https://code.google.com/p/word2vec/ï¼Œ éµå¾ª Apache License 2.0 å¼€æºåè®®ï¼Œæ˜¯ä¸€ç§å¯¹å•†ä¸šåº”ç”¨å‹å¥½çš„è®¸å¯ï¼Œå½“ç„¶éœ€è¦å…… åˆ†å°Šé‡åŸä½œè€…çš„è‘—ä½œæƒã€‚

word2vec ä¸€èˆ¬è¢«å¤–ç•Œè®¤ä¸ºæ˜¯ä¸€ä¸ª Deep Learning(æ·±åº¦å­¦ä¹ )çš„æ¨¡å‹ï¼Œç©¶å…¶åŸå› ï¼Œå¯èƒ½å’Œ word2vec çš„ä½œè€… Tomas Mikolov çš„ Deep Learning èƒŒæ™¯ä»¥åŠ word2vec æ˜¯ä¸€ç§ç¥ç»ç½‘ç»œæ¨¡å‹ç›¸å…³ï¼Œä½†æˆ‘ä»¬è°¨æ…è®¤ä¸ºè¯¥æ¨¡å‹å±‚æ¬¡è¾ƒæµ…ï¼Œä¸¥æ ¼æ¥è¯´è¿˜ä¸èƒ½ç®— æ˜¯æ·±å±‚æ¨¡å‹ã€‚å½“ç„¶å¦‚æœword2vecä¸Šå±‚å†å¥—ä¸€å±‚ä¸å…·ä½“åº”ç”¨ç›¸å…³çš„è¾“å‡ºå±‚ï¼Œæ¯”å¦‚ Softmaxï¼Œæ­¤æ—¶æ›´åƒæ˜¯ä¸€ä¸ªæ·±å±‚æ¨¡å‹ã€‚

word2vec é€šè¿‡è®­ç»ƒï¼Œå¯ä»¥æŠŠå¯¹æ–‡æœ¬å†…å®¹çš„å¤„ç†ç®€åŒ–ä¸º K ç»´å‘é‡ç©ºé—´ä¸­çš„å‘é‡ è¿ç®—ï¼Œè€Œå‘é‡ç©ºé—´ä¸Šçš„ç›¸ä¼¼åº¦å¯ä»¥ç”¨æ¥è¡¨ç¤ºæ–‡æœ¬è¯­ä¹‰ä¸Šçš„ç›¸ä¼¼åº¦ã€‚å› æ­¤ï¼Œword2vec è¾“å‡ºçš„è¯å‘é‡å¯ä»¥è¢«ç”¨æ¥åšå¾ˆå¤š NLP ç›¸å…³çš„å·¥ä½œï¼Œæ¯”å¦‚èšç±»ã€æ‰¾åŒä¹‰è¯ã€è¯æ€§åˆ† æç­‰ç­‰ã€‚è€Œ word2vec è¢«äººå¹¿ä¸ºä¼ é¢‚çš„åœ°æ–¹æ˜¯å…¶å‘é‡çš„åŠ æ³•ç»„åˆè¿ç®—(Additive Compositionality )ï¼Œ å®˜ ç½‘ ä¸Š çš„ ä¾‹ å­ æ˜¯ : vector('Paris') - vector('France') + vector('Italy')â‰ˆvector('Rome')ï¼Œvector('king') - vector('man') + vector('woman')â‰ˆ vector('queen')ã€‚ä½†æˆ‘ä»¬è®¤ä¸ºè¿™ä¸ªå¤šå°‘æœ‰ç‚¹è¢«è¿‡åº¦ç‚’ä½œäº†ï¼Œå¾ˆå¤šå…¶ä»–é™ç»´æˆ–ä¸»é¢˜ æ¨¡å‹åœ¨ä¸€å®šç¨‹åº¦ä¹Ÿèƒ½è¾¾åˆ°ç±»ä¼¼æ•ˆæœï¼Œè€Œä¸” word2vec ä¹Ÿåªæ˜¯å°‘é‡çš„ä¾‹å­å®Œç¾ç¬¦åˆ è¿™ç§åŠ å‡æ³•æ“ä½œï¼Œå¹¶ä¸æ˜¯æ‰€æœ‰çš„ case éƒ½æ»¡è¶³ã€‚

word2vec å¤§å—æ¬¢è¿çš„å¦ä¸€ä¸ªåŸå› æ˜¯å…¶é«˜æ•ˆæ€§ï¼ŒMikolov åœ¨è®ºæ–‡[2]ä¸­æŒ‡å‡ºä¸€ä¸ª ä¼˜åŒ–çš„å•æœºç‰ˆæœ¬ä¸€å¤©å¯è®­ç»ƒä¸Šåƒäº¿è¯ã€‚

![](https://github.com/bobkentt/Learning-machine-from-scratch-pic/blob/master/practice/pic/word2vec.png)

## èƒŒæ™¯çŸ¥è¯†
### è¯å‘é‡
1. [One-hot representation](https://github.com/bobkentt/Learning-machine-from-scratch-/blob/master/alg_base/One-hot-Representation.md)
2. [Distributed Representation](https://github.com/bobkentt/Learning-machine-from-scratch-/blob/master/alg_base/Distributed_Representation.md)
### ä¸»è¦æ€æƒ³
**è¯´èµ·æ¥word2vecï¼Œå…¶å®å°±æ˜¯æŠŠè¯æ˜ å°„æˆä¸€å®šç»´åº¦çš„ç¨ å¯†å‘é‡ï¼ŒåŒæ—¶ä¿æŒä½è¯å’Œè¯ä¹‹é—´çš„å…³è”æ€§ï¼Œä¸»è¦ä½“ç°åœ¨(æ¬§å¼)è·ç¦»çš„è¿œè¿‘ä¸Šã€‚**

### ç»Ÿè®¡è¯­è¨€æ¨¡å‹
ä¼ ç»Ÿçš„ç»Ÿè®¡è¯­è¨€æ¨¡å‹æ˜¯è¡¨ç¤ºè¯­è¨€åŸºæœ¬å•ä½(ä¸€èˆ¬ä¸ºå¥å­)çš„æ¦‚ç‡åˆ†å¸ƒå‡½æ•°ï¼Œ è¿™ä¸ªæ¦‚ç‡åˆ†å¸ƒä¹Ÿå°±æ˜¯è¯¥è¯­è¨€çš„ç”Ÿæˆæ¨¡å‹ã€‚ä¸€èˆ¬è¯­è¨€æ¨¡å‹å¯ä»¥ä½¿ç”¨å„ä¸ªè¯è¯­æ¡ä»¶æ¦‚ ç‡çš„å½¢å¼è¡¨ç¤º:

ğ‘(s) = ğ‘(ğ‘¤1ğ‘‡) = ğ‘(ğ‘¤1, ğ‘¤2,... , ğ‘¤ğ‘‡)=âˆğ‘‡ğ‘¡=1 ğ‘( ğ‘¤ğ‘¡|Context)

å…¶ä¸­ Context å³ä¸ºä¸Šä¸‹æ–‡ï¼Œæ ¹æ®å¯¹ Context ä¸åŒçš„åˆ’åˆ†æ–¹æ³•ï¼Œå¯ä»¥åˆ†ä¸ºäº”å¤§ç±»: 

#### (1)ä¸Šä¸‹æ–‡æ— å…³æ¨¡å‹(Context=NULL) 
è¯¥æ¨¡å‹ä»…ä»…è€ƒè™‘å½“å‰è¯æœ¬èº«çš„æ¦‚ç‡ï¼Œä¸è€ƒè™‘è¯¥è¯æ‰€å¯¹åº”çš„ä¸Šä¸‹æ–‡ç¯å¢ƒã€‚è¿™æ˜¯ä¸€ç§æœ€ç®€å•ï¼Œæ˜“äºå®ç°ï¼Œä½†æ²¡æœ‰å¤šå¤§å®é™…åº”ç”¨ä»·å€¼çš„ç»Ÿè®¡è¯­è¨€æ¨¡å‹ã€‚

ğ‘(ğ‘¤ğ‘¡|Context)= ğ‘(ğ‘¤ğ‘¡)=ğ‘ğ‘¤ğ‘¡ / ğ‘

è¿™ä¸ªæ¨¡å‹ä¸è€ƒè™‘ä»»ä½•ä¸Šä¸‹æ–‡ä¿¡æ¯ï¼Œä»…ä»…ä¾èµ–äºè®­ç»ƒæ–‡æœ¬ä¸­çš„è¯é¢‘ç»Ÿè®¡ã€‚å®ƒæ˜¯ n-gram æ¨¡å‹ä¸­å½“ n=1 çš„ç‰¹æ®Šæƒ…å½¢ï¼Œæ‰€ä»¥æœ‰æ—¶ä¹Ÿç§°ä½œ Unigram Model(ä¸€å…ƒæ–‡æ³•ç»Ÿè®¡æ¨¡å‹)ã€‚å®é™…åº”ç”¨ä¸­ï¼Œå¸¸è¢«åº”ç”¨åˆ°ä¸€äº›å•†ç”¨è¯­éŸ³è¯†åˆ«ç³»ç»Ÿä¸­ã€‚

#### (2)n-gram æ¨¡å‹(Context= ğ‘¤ğ‘¡âˆ’n+1, ğ‘¤ğ‘¡âˆ’n+2,... , ğ‘¤ğ‘¡âˆ’1)
n=1 æ—¶ï¼Œå°±æ˜¯ä¸Šé¢æ‰€è¯´çš„ä¸Šä¸‹æ–‡æ— å…³æ¨¡å‹ï¼Œè¿™é‡Œ n-gram ä¸€èˆ¬è®¤ä¸ºæ˜¯ N>=2 æ˜¯ çš„ä¸Šä¸‹æ–‡ç›¸å…³æ¨¡å‹ã€‚å½“ n=2 æ—¶ï¼Œä¹Ÿç§°ä¸º Bigram è¯­è¨€æ¨¡å‹ï¼Œç›´è§‚çš„æƒ³ï¼Œåœ¨è‡ªç„¶è¯­ è¨€ä¸­ â€œç™½è‰²æ±½è½¦â€çš„æ¦‚ç‡æ¯”â€œç™½è‰²é£ç¿”â€çš„æ¦‚ç‡è¦å¤§å¾ˆå¤šï¼Œä¹Ÿå°±æ˜¯ p(æ±½è½¦|ç™½è‰²)> p(é£ç¿”|ç™½è‰²)ã€‚n>2 ä¹Ÿç±»ä¼¼ï¼Œåªæ˜¯å¾€å‰çœ‹ n-1 ä¸ªè¯è€Œä¸æ˜¯ä¸€ä¸ªè¯ã€‚

ä¸€èˆ¬ n-gram æ¨¡å‹ä¼˜åŒ–çš„ç›®æ ‡æ˜¯æœ€å¤§ log ä¼¼ç„¶ï¼Œå³:

âˆğ‘‡ğ‘¡=1 ğ‘ğ‘¡( ğ‘¤ğ‘¡|ğ‘¤ğ‘¡âˆ’n+1, ğ‘¤ğ‘¡âˆ’n+2,... , ğ‘¤ğ‘¡âˆ’1)logğ‘ğ‘š(ğ‘¤ğ‘¡|ğ‘¤ğ‘¡âˆ’n+1, ğ‘¤ğ‘¡âˆ’n+2,... , ğ‘¤ğ‘¡âˆ’1)

n-gram æ¨¡å‹çš„ä¼˜ç‚¹åŒ…å«äº†å‰ N-1 ä¸ªè¯æ‰€èƒ½æä¾›çš„å…¨éƒ¨ä¿¡æ¯ï¼Œè¿™äº›ä¿¡æ¯å¯¹å½“å‰è¯å‡ºç°å…·æœ‰å¾ˆå¼ºçš„çº¦æŸåŠ›ã€‚åŒæ—¶å› ä¸ºåªçœ‹ N-1 ä¸ªè¯è€Œä¸æ˜¯æ‰€æœ‰è¯ä¹Ÿä½¿å¾—æ¨¡å‹çš„æ•ˆç‡è¾ƒé«˜ã€‚

n-gram è¯­è¨€æ¨¡å‹ä¹Ÿå­˜åœ¨ä¸€äº›é—®é¢˜:

1. n-gram è¯­è¨€æ¨¡å‹æ— æ³•å»ºæ¨¡æ›´è¿œçš„å…³ç³»ï¼Œè¯­æ–™çš„ä¸è¶³ä½¿å¾—æ— æ³•è®­ç»ƒæ›´é«˜é˜¶çš„ è¯­è¨€æ¨¡å‹ã€‚å¤§éƒ¨åˆ†ç ”ç©¶æˆ–å·¥ä½œéƒ½æ˜¯ä½¿ç”¨ Trigramï¼Œå°±ç®—ä½¿ç”¨é«˜é˜¶çš„æ¨¡å‹ï¼Œå…¶ç»Ÿè®¡ åˆ°çš„æ¦‚ç‡å¯ä¿¡åº¦å°±å¤§æ‰“æŠ˜æ‰£ï¼Œè¿˜æœ‰ä¸€äº›æ¯”è¾ƒå°çš„é—®é¢˜é‡‡ç”¨ Bigramã€‚
2. è¿™ç§æ¨¡å‹æ— æ³•å»ºæ¨¡å‡ºè¯ä¹‹é—´çš„ç›¸ä¼¼åº¦ï¼Œæœ‰æ—¶å€™ä¸¤ä¸ªå…·æœ‰æŸç§ç›¸ä¼¼æ€§çš„è¯ï¼Œ å¦‚æœä¸€ä¸ªè¯ç»å¸¸å‡ºç°åœ¨æŸæ®µè¯ä¹‹åï¼Œé‚£ä¹ˆä¹Ÿè®¸å¦ä¸€ä¸ªè¯å‡ºç°åœ¨è¿™æ®µè¯åé¢çš„æ¦‚ç‡ ä¹Ÿæ¯”è¾ƒå¤§ã€‚æ¯”å¦‚â€œç™½è‰²çš„æ±½è½¦â€ç»å¸¸å‡ºç°ï¼Œé‚£å®Œå…¨å¯ä»¥è®¤ä¸ºâ€œç™½è‰²çš„è½¿è½¦â€ä¹Ÿå¯ èƒ½ç»å¸¸å‡ºç°ã€‚
3. è®­ç»ƒè¯­æ–™é‡Œé¢æœ‰äº› n å…ƒç»„æ²¡æœ‰å‡ºç°è¿‡ï¼Œå…¶å¯¹åº”çš„æ¡ä»¶æ¦‚ç‡å°±æ˜¯ 0ï¼Œå¯¼è‡´è®¡ ç®—ä¸€æ•´å¥è¯çš„æ¦‚ç‡ä¸º 0ã€‚è§£å†³è¿™ä¸ªé—®é¢˜æœ‰ä¸¤ç§å¸¸ç”¨æ–¹æ³•:

* æ–¹æ³•ä¸€ä¸ºå¹³æ»‘æ³•ã€‚æœ€ç®€å•çš„æ–¹æ³•æ˜¯æŠŠæ¯ä¸ª n å…ƒç»„çš„å‡ºç°æ¬¡æ•°åŠ  1ï¼Œé‚£ä¹ˆåŸæ¥ å‡ºç° k æ¬¡çš„æŸä¸ª n å…ƒç»„å°±ä¼šè®°ä¸º k+1 æ¬¡ï¼ŒåŸæ¥å‡ºç° 0 æ¬¡çš„ n å…ƒç»„å°±ä¼šè®°ä¸ºå‡ºç° 1 æ¬¡ã€‚è¿™ç§ä¹Ÿç§°ä¸º Laplace å¹³æ»‘ã€‚å½“ç„¶è¿˜æœ‰å¾ˆå¤šæ›´å¤æ‚çš„å…¶ä»–å¹³æ»‘æ–¹æ³•ï¼Œå…¶æœ¬è´¨éƒ½ æ˜¯å°†æ¨¡å‹å˜ä¸ºè´å¶æ–¯æ¨¡å‹ï¼Œé€šè¿‡å¼•å…¥å…ˆéªŒåˆ†å¸ƒæ‰“ç ´ä¼¼ç„¶ä¸€ç»Ÿå¤©ä¸‹çš„å±€é¢ã€‚è€Œå¼•å…¥ å…ˆéªŒæ–¹æ³•çš„ä¸åŒä¹Ÿå°±äº§ç”Ÿäº†å¾ˆå¤šä¸åŒçš„å¹³æ»‘æ–¹æ³•ã€‚

* æ–¹æ³•äºŒæ˜¯å›é€€æ³•ã€‚æœ‰ç‚¹åƒå†³ç­–æ ‘ä¸­çš„åå‰ªææ–¹æ³•ï¼Œå³å¦‚æœ n å…ƒçš„æ¦‚ç‡ä¸åˆ°ï¼Œ é‚£å°±å¾€ä¸Šå›é€€ä¸€æ­¥ï¼Œç”¨ n-1 å…ƒçš„æ¦‚ç‡ä¹˜ä¸Šä¸€ä¸ªæƒé‡æ¥æ¨¡æ‹Ÿã€‚

#### (3)n-posæ¨¡å‹(Context= ğ‘(ğ‘¤ğ‘¡âˆ’n+1),ğ‘(ğ‘¤ğ‘¡âˆ’n+2),...,ğ‘(ğ‘¤ğ‘¡âˆ’1))
ä¸¥æ ¼æ¥è¯´ n-pos åªæ˜¯ n-gram çš„ä¸€ç§è¡ç”Ÿæ¨¡å‹ã€‚n-gram æ¨¡å‹å‡å®šç¬¬ t ä¸ªè¯å‡ºç° æ¦‚ç‡æ¡ä»¶ä¾èµ–å®ƒå‰ N-1 ä¸ªè¯ï¼Œè€Œç°å®ä¸­å¾ˆå¤šè¯å‡ºç°çš„æ¦‚ç‡æ˜¯æ¡ä»¶ä¾èµ–äºå®ƒå‰é¢è¯ çš„è¯­æ³•åŠŸèƒ½çš„ã€‚n-pos æ¨¡å‹å°±æ˜¯åŸºäºè¿™ç§å‡è®¾çš„æ¨¡å‹ï¼Œå®ƒå°†è¯æŒ‰ç…§å…¶è¯­æ³•åŠŸèƒ½è¿› è¡Œåˆ†ç±»ï¼Œç”±è¿™äº›è¯ç±»å†³å®šä¸‹ä¸€ä¸ªè¯å‡ºç°çš„æ¦‚ç‡ã€‚è¿™æ ·çš„è¯ç±»ç§°ä¸ºè¯æ€§ (Part-of-Speechï¼Œç®€ç§°ä¸º POS)ã€‚n-pos æ¨¡å‹ä¸­çš„æ¯ä¸ªè¯çš„æ¡ä»¶æ¦‚ç‡è¡¨ç¤ºä¸º:

ğ‘(s) = ğ‘(ğ‘¤1ğ‘‡)= ğ‘(ğ‘¤1,ğ‘¤2,...,ğ‘¤ğ‘‡)=âˆğ‘‡ğ‘¡=1ğ‘(ğ‘¤ğ‘¡|ğ‘(ğ‘¤ğ‘¡âˆ’n+1),ğ‘(ğ‘¤ğ‘¡âˆ’n+2),...,ğ‘(ğ‘¤ğ‘¡âˆ’1)) 

c ä¸ºç±»åˆ«æ˜ å°„å‡½æ•°ï¼Œå³æŠŠ T ä¸ªè¯æ˜ å°„åˆ° K ä¸ªç±»åˆ«ã€‚

å®é™…ä¸Š n-Posä½¿ç”¨äº†ä¸€ç§èšç±»çš„æ€æƒ³ï¼Œä½¿å¾—åŸæ¥ n-gram ä¸­ğ‘¤ğ‘¡âˆ’n+1, ğ‘¤ğ‘¡âˆ’n+2,... , ğ‘¤ğ‘¡âˆ’1ä¸­çš„å¯èƒ½ä¸º

TN-1 å‡å°‘åˆ°ğ‘(ğ‘¤ğ‘¡âˆ’n+1),ğ‘(ğ‘¤ğ‘¡âˆ’n+2),...,ğ‘(ğ‘¤ğ‘¡âˆ’1)ä¸­çš„ KN-1ï¼ŒåŒæ—¶è¿™ç§å‡å°‘è¿˜é‡‡ç”¨äº†è¯­ä¹‰æœ‰æ„ä¹‰çš„ç±»åˆ«ã€‚

#### (4)åŸºäºå†³ç­–æ ‘çš„è¯­è¨€æ¨¡å‹
ä¸Šé¢æåˆ°çš„ä¸Šä¸‹æ–‡æ— å…³è¯­è¨€æ¨¡å‹ã€n-gram è¯­è¨€æ¨¡å‹ã€n-pos è¯­è¨€æ¨¡å‹ç­‰ç­‰ï¼Œ
éƒ½å¯ä»¥ä»¥ç»Ÿè®¡å†³ç­–æ ‘çš„å½¢å¼è¡¨ç¤ºå‡ºæ¥ã€‚è€Œç»Ÿè®¡å†³ç­–æ ‘ä¸­æ¯ä¸ªç»“ç‚¹çš„å†³ç­–è§„åˆ™æ˜¯ä¸€ ä¸ªä¸Šä¸‹æ–‡ç›¸å…³çš„é—®é¢˜ã€‚è¿™äº›é—®é¢˜å¯ä»¥æ˜¯â€œå‰ä¸€ä¸ªè¯æ—¶ w å—?â€â€œå‰ä¸€ä¸ªè¯å±äºç±» åˆ« ci å—?â€ã€‚å½“ç„¶åŸºäºå†³ç­–æ ‘çš„è¯­è¨€æ¨¡å‹è¿˜å¯ä»¥æ›´çµæ´»ä¸€äº›ï¼Œå¯ä»¥æ˜¯ä¸€äº›â€œå‰ä¸€ ä¸ªè¯æ˜¯åŠ¨è¯?â€ï¼Œâ€œåé¢æœ‰ä»‹è¯å—?â€ä¹‹ç±»çš„å¤æ‚è¯­æ³•è¯­ä¹‰é—®é¢˜ã€‚

åŸºäºå†³ç­–æ ‘çš„è¯­è¨€æ¨¡å‹ä¼˜ç‚¹æ˜¯:åˆ†å¸ƒæ•°ä¸æ˜¯é¢„å…ˆå›ºå®šå¥½çš„ï¼Œè€Œæ˜¯æ ¹æ®è®­ç»ƒé¢„ æ–™åº“ä¸­çš„å®é™…æƒ…å†µç¡®å®šï¼Œæ›´ä¸ºçµæ´»ã€‚ç¼ºç‚¹æ˜¯:æ„é€ ç»Ÿè®¡å†³ç­–æ ‘çš„é—®é¢˜å¾ˆå›°éš¾ï¼Œä¸” æ—¶ç©ºå¼€é”€å¾ˆå¤§ã€‚

#### (5)æœ€å¤§ç†µæ¨¡å‹
æœ€å¤§ç†µåŸç†æ˜¯E.T. Jaynessäºä¸Šä¸–çºª50å¹´ä»£æå‡ºçš„ï¼Œå…¶åŸºæœ¬æ€æƒ³æ˜¯:å¯¹ä¸€ä¸ª éšæœºäº‹ä»¶çš„æ¦‚ç‡åˆ†å¸ƒè¿›è¡Œé¢„æµ‹æ—¶ï¼Œåœ¨æ»¡è¶³å…¨éƒ¨å·²çŸ¥çš„æ¡ä»¶ä¸‹å¯¹æœªçŸ¥çš„æƒ…å†µä¸åšä»» ä½•ä¸»è§‚å‡è®¾ã€‚ä»ä¿¡æ¯è®ºçš„è§’åº¦æ¥è¯´å°±æ˜¯:åœ¨åªæŒæ¡å…³äºæœªçŸ¥åˆ†å¸ƒçš„éƒ¨åˆ†çŸ¥è¯†æ—¶ï¼Œ åº”å½“é€‰å–ç¬¦åˆè¿™äº›çŸ¥è¯†ä½†åˆèƒ½ä½¿å¾—ç†µæœ€å¤§çš„æ¦‚ç‡åˆ†å¸ƒã€‚
ğ‘(w|Context) =ğ‘’âˆ‘ğ‘– ğœ†ğ‘–ğ‘“ğ‘–(ğ‘ğ‘œğ‘›ğ‘¡ğ‘’ğ‘¥ğ‘¡,ğ‘¤) ğ‘(ğ¶ğ‘œğ‘›ğ‘¡ğ‘’ğ‘¥ğ‘¡)
å…¶ä¸­ğœ†ğ‘–æ˜¯å‚æ•°ï¼Œğ‘(ğ¶ğ‘œğ‘›ğ‘¡ğ‘’ğ‘¥ğ‘¡)ä¸ºå½’ä¸€åŒ–å› å­ï¼Œå› ä¸ºé‡‡ç”¨çš„æ˜¯è¿™ç§ Softmax å½¢å¼ï¼Œ æ‰€ä»¥æœ€å¤§ç†µæ¨¡å‹æœ‰æ—¶å€™ä¹Ÿç§°ä¸ºæŒ‡æ•°æ¨¡å‹ã€‚
#### (6)è‡ªé€‚åº”è¯­è¨€æ¨¡å‹
å‰é¢çš„æ¨¡å‹æ¦‚ç‡åˆ†å¸ƒéƒ½æ˜¯é¢„å…ˆä»è®­ç»ƒè¯­æ–™åº“ä¸­ä¼°ç®—å¥½çš„ï¼Œå±äºé™æ€è¯­è¨€æ¨¡å‹ã€‚ è€Œè‡ªé€‚åº”è¯­è¨€æ¨¡å‹ç±»ä¼¼æ˜¯ Online Learning çš„è¿‡ç¨‹ï¼Œå³æ ¹æ®å°‘é‡æ–°æ•°æ®åŠ¨æ€è°ƒæ•´æ¨¡ å‹ï¼Œå±äºåŠ¨æ€æ¨¡å‹ã€‚åœ¨è‡ªç„¶è¯­è¨€ä¸­ï¼Œç»å¸¸å‡ºç°è¿™æ ·ç°è±¡:æŸäº›åœ¨æ–‡æœ¬ä¸­é€šå¸¸å¾ˆå°‘ å‡ºç°çš„è¯ï¼Œåœ¨æŸä¸€å±€éƒ¨æ–‡æœ¬ä¸­çªç„¶å¤§é‡åœ°å‡ºç°ã€‚èƒ½å¤Ÿæ ¹æ®è¯åœ¨å±€éƒ¨æ–‡æœ¬ä¸­å‡ºç°çš„ æƒ…å†µåŠ¨æ€åœ°è°ƒæ•´è¯­è¨€æ¨¡å‹ä¸­çš„æ¦‚ç‡åˆ†å¸ƒæ•°æ®çš„è¯­è¨€æ¨¡å‹æˆä¸ºåŠ¨æ€ã€è‡ªé€‚åº”æˆ–è€…åŸº äºç¼“å­˜çš„è¯­è¨€æ¨¡å‹ã€‚é€šå¸¸çš„åšæ³•æ˜¯å°†é™æ€æ¨¡å‹ä¸åŠ¨æ€æ¨¡å‹é€šè¿‡å‚æ•°èåˆåˆ°ä¸€èµ·ï¼Œ è¿™ç§æ··åˆæ¨¡å‹å¯ä»¥æœ‰æ•ˆåœ°é¿å…æ•°æ®ç¨€ç–çš„é—®é¢˜ã€‚

è¿˜æœ‰ä¸€ç§ä¸»é¢˜ç›¸å…³çš„è‡ªé€‚åº”è¯­è¨€æ¨¡å‹ï¼Œç›´è§‚çš„ä¾‹å­ä¸º:ä¸“é—¨é’ˆå¯¹ä½“è‚²ç›¸å…³å†… å®¹è®­ç»ƒä¸€ä¸ªè¯­è¨€æ¨¡å‹ï¼ŒåŒæ—¶ä¿ç•™æ‰€æœ‰è¯­æ–™è®­ç»ƒçš„æ•´ä½“è¯­è¨€æ¨¡å‹ï¼Œå½“æ–°æ¥çš„æ•°æ®å± äºä½“è‚²ç±»åˆ«æ—¶ï¼Œå…¶åº”è¯¥ä½¿ç”¨çš„æ¨¡å‹å°±æ˜¯ä½“è‚²ç›¸å…³ä¸»é¢˜æ¨¡å‹å’Œæ•´ä½“è¯­è¨€æ¨¡å‹ç›¸èåˆ çš„æ··åˆæ¨¡å‹ã€‚

## NNLM
NNLM æ˜¯ Neural Network Language Model çš„ç¼©å†™ï¼Œå³ç¥ç»ç½‘ç»œè¯­è¨€æ¨¡å‹ã€‚ç¥ ç»ç½‘ç»œè¯­è¨€æ¨¡å‹æ–¹é¢æœ€å€¼å¾—é˜…è¯»çš„æ–‡ç« æ˜¯ Deep Learning äººç‰©Bengio çš„ã€ŠA Neural Probabilistic Language Modelã€‹ï¼ŒJMLR 2003ã€‚

NNLM é‡‡ç”¨çš„æ˜¯ Distributed Representationï¼Œå³æ¯ä¸ªè¯è¢«è¡¨ç¤ºä¸ºä¸€ä¸ªæµ®ç‚¹å‘é‡ã€‚ å…¶æ¨¡å‹å›¾å¦‚ä¸‹:

![](https://pic3.zhimg.com/61f31ca272dcd40ad0a3d05efc3172a2_b.jpg)


> æœ¬æ–‡å‚è€ƒblog[Deep Learningå®æˆ˜ä¹‹word2vec](http://techblog.youdao.com/?p=915#LinkTarget_699)
